create sequence refresh_token_seq start with 1 increment by 50;
create table file_node (has_thumbnail boolean, created_at timestamp(6), size bigint, updated_at timestamp(6), id uuid not null, parent_id uuid, user_id uuid not null, mime_type varchar(255), name varchar(255) not null, object_id varchar(255), thumbnail_path varchar(255), type varchar(255) not null, primary key (id));
create table file_system_changes (time_stamp timestamp(6), file_id uuid, id uuid not null, old_parent_id uuid, parent_id uuid, user_id uuid, event_type varchar(255) check (event_type in ('CREATED','MODIFIED','DELETED','MOVED')), snap_shot_json oid, primary key (id));
create table refresh_token (created_at timestamp(6) with time zone, expires_at timestamp(6) with time zone, id bigint not null, email varchar(255) not null, hashed_token varchar(255) not null, primary key (id));
create table upload_parts (part_number integer not null, session_id uuid not null, etag varchar(255), primary key (part_number, session_id));
create table upload_sessions (has_thumbnail boolean, created_at timestamp(6), last_updated_at timestamp(6), total_size bigint not null, uploaded_size bigint not null, id uuid not null, user_id uuid not null, file_name varchar(255), object_key varchar(255), parent_id varchar(255), s3_upload_id varchar(255), status varchar(255) check (status in ('IN_PROGRESS','COMPLETED','CANCELLED')), thumbnail_path varchar(255), primary key (id));
create table upload_session_uploaded_chunks (uploaded_chunks bigint, upload_session_id uuid not null);
create table users (is_enabled boolean not null, quota_limit_mb integer not null, used_space_mb integer not null, created_at timestamp(6) not null, id uuid not null, auth_type varchar(255) not null, avatar_uri varchar(255), email varchar(255) not null unique, first_name varchar(255), last_name varchar(255), password_hash varchar(255), primary key (id));
alter table if exists upload_parts add constraint FKmcxn1r44xgj47fefxkh0n99fw foreign key (session_id) references upload_sessions;
alter table if exists upload_session_uploaded_chunks add constraint FK1v0inoc4a1jq4i0ii95vdonro foreign key (upload_session_id) references upload_sessions;
